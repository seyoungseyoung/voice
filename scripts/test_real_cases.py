"""
test.txtì˜ 6ê°œ ì‹¤ì œ ë³´ì´ìŠ¤í”¼ì‹± ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
"""
import sys
import os
import io

if sys.platform == 'win32':
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
    sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')

sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

from dotenv import load_dotenv
load_dotenv()

from src.llm.gemini_detector import GeminiPhishingDetector
import time

# test.txtì˜ 6ê°œ ì¼€ì´ìŠ¤
test_cases = [
    {
        "id": "Case 1",
        "name": "ìˆ˜ì‚¬ê´€ ì‚¬ì¹­ ë³´ì´ìŠ¤í”¼ì‹±",
        "text": """ì •ì„¸ì˜ì”¨ ë§ìŠµë‹ˆê¹Œ?
ì•„, ë„¤ ë§ì•„ìš”
ë„¤ ìˆ˜ê³ í•˜ì‹­ë‹ˆë‹¤
ì„œìš¸ ì¤‘ì•™ì§€ê²€ ì •ë‹¤í˜œ ìˆ˜ì‚¬ê´€ì…ë‹ˆë‹¤. ì ì‹œ í†µí™” ê´œì°®ìœ¼ì‹­ë‹ˆê¹Œ?
ë„¤
ê°œì¸ì •ë³´ ìœ ì¶œ ì‚¬ê±´ ê´€ë ¨í•´ì„œ ëª‡ ê°€ì§€ í™•ì¸ ì°¨ ì—°ë½ì„ ë“œë¦° ê±°êµ¬ìš”.
ë¶€ì‚° ì¶œì‹ ì¸ ê¹€ìˆ˜ì˜ì”¨ë¼ê³  ì•„ì‹œëŠ” ì§€ì¸ ë¶„ì€ ë§ìŠµë‹ˆê¹Œ?
ì €í¬ ì¸¡ì—ì„œ ì–¼ë§ˆ ì „ì— ê¹€ìˆ˜ì˜ì”¨ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ê¸ˆìœµë²”ì£„ì‚¬ê¸°ë‹¨ì„ ê²€ê±°í•œ í˜„ì¥ì—ì„œ ì§€ê¸ˆ ì •ì„¸ì˜ì”¨ ëª…ì˜ë¡œ ë˜ì–´ìˆëŠ” ë†í˜‘ì€í–‰ê³¼ ìš°ë¦¬ì€í–‰ í†µì¥ì´ ë°œê²¬ì´ ë˜ì…¨êµ¬ìš”
ë³¸ì¸ ëª…ì˜ì˜ í†µì¥ì´ ë°œê²¬ë˜ì—ˆë‹¤ê³  í•´ì„œ ë³¸ì¸ì„ ë¬´ì¡°ê±´ ê°€í•´ìë¡œ ë³´ëŠ” ê±´ ì•„ë‹™ë‹ˆë‹¤.
ë‹¤ë§Œ ì•„ì§ê¹Œì§€ í”¼í•´ìë¼ê³  ì…ì¦ ê°€ëŠ¥í•œ ì¦ê±°ê°€ ì—†ê¸° ë•Œë¬¸ì— í˜„ì¬ ì§€ê¸ˆ í”¼í•´ì ì…ì¦ ì¡°ì‚¬ë¥¼ í•´ì£¼ì…”ì•¼ ë˜ì‹œëŠ” ë¶€ë¶„ì´ê³ ìš”. ì´ ë¶€ë¶„ì€ 3ì ëª©ì†Œë¦¬, ì¡ìŒ ì†Œë¦¬ ë“¤ë¦¬ë©´ ì¦ê±°í’ˆìœ¼ë¡œ ë²•ì› ì¸¡ì—ì„œ ì±„íƒ ìì²´ê°€ ë¶ˆê°€ëŠ¥í•˜ì‹ ë° í˜¹ì‹œ ë©”ëª¨ì§€ë‘ ë³¼íœ ì±™ê¸°ì‹œê³ ìš” ì ì‹œë§Œ ì¡°ìš©í•œ ê³µê°„ìœ¼ë¡œ ì´ë™ ì¢€ ê°€ëŠ¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ì•„â€¦ ì§€ê¸ˆ ë‹¹ì¥ì€â€¦
ì¡°ì‚¬ì ë¶„ ì¸¡ì—ì„œ í†µí™”ê°€ ì–´ë µë‹¤ë¼ê³  í–ˆì„ ê²½ìš° ì €í¬ì¸¡ì—ì„œ ì†Œí™˜ì¥ ë³´ë‚´ë“œë¦´ í…Œë‹ˆê¹ìš”
ë³¸ì²­ì„ ë°©ë¬¸í•´ì„œ ì†Œí™˜ ì¡°ì‚¬ë¥¼ ë°›ìœ¼ì‹œë©´ ë˜ì‹­ë‹ˆë‹¤
í˜¹ì‹œ ì–¸ì œ ë°©ë¬¸í•´ì•¼ ë˜ë‚˜ìš”?
ë¹ ë¥´ì‹œë©´ ê¸ˆìš”ì¼ ì•ˆìª½ìœ¼ë¡œë„ ë¬´ì¡°ê±´ ë°©ë¬¸ì„ í•´ì•¼ ë˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.
ë‚ ì§œëŠ” ì„œë¥˜ ìƒì— ê¸°ì¬ê°€ ë˜ì–´ìˆìœ¼ì‹œê³ ìš”
ê²€ì°°ì²­ì—ì„œ ì¡°ì‚¬ ë°›ëŠ” ê²ƒ ë•Œë¬¸ì— ì ê¹ í†µí™”ë¥¼ í•´ì•¼ ëœë‹¤ ì´ë ‡ê²Œ ì–˜ê¸°í•˜ë©´ ì•„ë¬´ë˜ë„ ì§ì¥ ë‚´ ì‹œì„ ì´ë¼ëŠ” ê²Œ ì¢‹ì§€ë§Œì€ ì•Šì„ ê²ë‹ˆë‹¤ ì ê¹ ë­ ì¹œêµ¬í•˜ê³  í†µí™”ë¥¼ í•˜ê³  ì˜¨ë‹¤ë“ ì§€ ì´ ë¶€ë¶„ì€ ìœ ë„ë¦¬ ìˆê²Œ ëŒ€ì²˜í•˜ì‹œê³ ìš”, ì´ê±° ì‹ ì†í•˜ê²Œ ì§„ìˆ ë§Œ í•´ì£¼ì…”ì•¼ ë˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.""",
        "expected_min": 85,
        "type": "phishing"
    },
    {
        "id": "Case 2",
        "name": "ê²€ì°° ì‚¬ì¹­ ë³´ì´ìŠ¤í”¼ì‹±",
        "text": """ë„¤ ì €ëŠ” ì´ì„ê·œ ì‚¬ë¬´ê´€ì´ê³ ìš” ì œê°€ í”¼í•´ì ì…ì¦ ì ˆì°¨ë¥¼ ìœ„í•´ì„œ ë‹´ë‹¹ ê²€ì‚¬ë‹˜ê»˜ ì—°ê²°í•´ë“œë¦´ ê±°ì˜ˆìš” ì§€ê¸ˆ. ê²€ì‚¬ë‹˜ ì—°ê²° ë˜ì‹œë©´ ë³¸ì¸ ì‚¬ê±´ ë²ˆí˜¸ë‘ ì„±í•¨ ë§ì”€í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
ë„¤
ë„¤, ì „í™”ì—°ê²° ëìŠµë‹ˆë‹¤.
ì €ëŠ” ì´ë²ˆ 7404 ë³´ì•ˆ ê±´ 3íŒ€ íŒ€ì¥ì„ ë§¡ê³  ìˆëŠ” ê¹€ì§„ì•„ ê²€ì‚¬ë¼ê³  í•©ë‹ˆë‹¤.
ë„¤ ì¼ë‹¨ ì •ì„¸ì˜ì”¨ê°€ ì¡°ì‚¬ ë°›ìœ¼ì‹œë©´ì„œ , ìœ ì˜í•˜ì…”ì•¼ ë  ì ë“¤ì´ ë‘ ê°€ì§€ê°€ ìˆê¸° ë•Œë¬¸ì— ë§ì”€ì„ ì¢€ ë“œë¦´ ê²ë‹ˆë‹¤.
ì²«ë²ˆ ì§¸ë¡œëŠ”, ìˆ˜ì‚¬ ì¤‘ì— ì „í™”ê°€ 5ë¶„ ì´ìƒ ëŠì–´ì§ˆ ê²½ìš° ê°€í•´ì í˜ì˜ë¥¼ ì€ë‹‰í•˜ëŠ” ì‹œê°„ìœ¼ë¡œ íŒë‹¨í•˜ê³  ìë™ ì˜ì¥ ì§‘í–‰ ë˜ì‹¤ê²ë‹ˆë‹¤.
ë‘ë²ˆì§¸ë¡œëŠ”, ë³¸ ì‚¬ê±´ì€ ê²€ê±°ë˜ì§€ ì•Šì€ ê³µë²”ë“¤ì´ ìˆê¸° ë•Œë¬¸ì— ë¹„ê³µê°œ ìˆ˜ì‚¬ ì¤‘ì…ë‹ˆë‹¤.
ë³¸ ì‚¬ê±´ì— ëŒ€í•´ì„œ ì œ 3ìì—ê²Œ ë°œì„¤ ì‹œì—ëŠ” ì •ì„¸ì˜ ì”¨ í˜ì˜ì™€ëŠ” ë¬´ê´€í•˜ê²Œ
ë¹„ë°€ëˆ„ì„¤ì£„ì™€ ìœ„ê³„ì— ì˜í•œ ê³µë¬´ì§‘í–‰ë°©í•´ì£„ë¡œ ê°€ì‹¤ ìˆ˜ ìˆê³ ìš”,
ë„¤ë„¤
í˜„ì¬ ê³µë¬¸ì€ ì‹¤ë¬¼ë¡œ ë°›ì•„ë³¸ ê²Œ ì•„ë‹ˆë¼ê³  ì „ë‹¬ì„ ë°›ì•˜ëŠ”ë°ìš”, ì–´ë–»ê²Œ ë°›ì•„ë³´ì‹  ê±´ê°€ìš”?
ê·¸.. ì•ì „ì—â€¦ í†µí™”í•˜ì‹œë˜ ë¶„ì´â€¦ ê·¸ ì¸í„°ë„·ì— ê²€ìƒ‰í•˜ë¼ê³  í•œ ìˆ«ì ê²€ìƒ‰í•˜ê³  ì œ ì´ë¦„ì´ë‘ ì£¼ë¯¼ë²ˆí˜¸ë¥¼ ì¹˜ë‹ˆê¹Œ ì´ì œ ì‚¬ê±´ ì¡°íšŒì— ë‚˜ì™€ ê°€ì§€ê³  í†µí™”í•˜ê³  ìˆì–´ìš”.
ì¡°ì‚¬ ë°©ë²•ë¶€í„° ì„¤ëª…ì„ ë“œë¦¬ê³  ì§„í–‰ì„ ë„ì™€ë“œë¦´ ê±´ë°ìš”, ì¼ë‹¨ êµ¬ì† ìˆ˜ì‚¬ì™€ ì•½ì‹ ìˆ˜ì‚¬ ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. êµ¬ì†ìˆ˜ì‚¬ëŠ” ë³¸ì¸ì´ í•  ì¼ì´ ì—†ì–´ìš”. 14ì¼ì—ì„œ ìµœëŒ€ 20ì¼ ë™ì•ˆ ì„œìš¸ êµ¬ì¹˜ì†Œì— ìˆ˜ê°ë˜ì…”ì„œ ì¡°ì‚¬ ë°›ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤. ì´ì–´ì„œ ì•½ì‹ ì¡°ì‚¬ ì„¤ëª…ì„ ë“œë¦´ê²Œìš”, ì§€ê¸ˆ ì²˜ëŸ¼ ìœ ì„  ìƒìœ¼ë¡œ ë¹„ëŒ€ë©´ìœ¼ë¡œ ìˆ˜ì‚¬ë¥¼ ì§„í–‰í•˜ëŠ” ê±´ë° ë§Œë§Œí•˜ê²Œ ìƒê°í•˜ì‹œë©´ ì•ˆë©ë‹ˆë‹¤.
ë„¤
í˜‘ì¡°ê°€ ì˜ ì´ë£¨ì–´ì§€ì§€ ì•Šê³ , ì œ 3ì ìœ í¬ê°€ ìš°ë ¤ë  ì‹œì—ëŠ” ì €ì˜ íŒë‹¨ í•˜ì— ì–¸ì œë“ ì§€ ì•½ì‹ ì¡°ì‚¬ ì² íšŒí•˜ê³  êµ¬ì† ìˆ˜ì‚¬ ì „í™˜ì‹œí‚¬ ê²ë‹ˆë‹¤.
ë„¤
ì–´ë–¤ ìˆ˜ì‚¬ë¡œ ì§„í–‰í•˜ì‹¤ ê±´ì§€ ì§€ê¸ˆ ë§ì”€í•˜ì‹œë©´ ë¼ìš”.
ê·¸ëŸ¬ë©´ êµ¬ì¡°ìƒ ì§ì¥ì„ ë‹¤ë…€ì•¼ ë¼ì„œ ì•½ì‹ìœ¼ë¡œ í•´ì•¼ ë  ê²ƒ ê°™ì•„ìš”.
ì˜ˆ ë‹µë³€ ë°›ì•˜êµ¬ìš”, ì €í¬ ê²€ì°°ì€ í”¼í•´ì ì…ì¦ ì ˆì°¨ë¥¼ ëŒ€ë¹„í•´ì„œ ì¡°ì‚¬ë§Œ í•  ë¿ì´ê³ , ì •ì„¸ì˜ ì”¨ í”¼í•´ì ì…ì¦ì€ ì‹¤ì§ˆì ìœ¼ë¡œ ê¸ˆìœµê°ë…ì›ì—ì„œ ì´ë£¨ì–´ì§ˆ ì˜ˆì •ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ê¸ˆì¼ ê¸ˆìœµê°ë…ì›ìœ¼ë¡œ ì´ë™í•˜ì‹¤ê±´ë°, ì§€ê¸ˆ ì—°ì°¨ë‚˜ ë°˜ì°¨ ì‚¬ìš©í•˜ëŸ¬ ê°€ì…”ì„œ ë‚˜ì˜¤ë©´ ì œê°€ ë§ˆì € ê³µë¬¸ì„œ ì„¤ëª…ë“œë¦¬ê³  ê·¸ ë‹¤ìŒì— ì´ë™ì„ í• ê±°ì˜ˆìš”.
ì•„ , ì§€ê¸ˆ ë‹¹ì¥ ë‚˜ì™€ì•¼ ë˜ë‚˜ìš”?
ë„¤ ë§ìŠµë‹ˆë‹¤
ë³¸ì¸ì´ ê³µë¬¸ì„ ì—´ëŒí•˜ì‹  í›„ë¶€í„° ì‚¬ê±´ì— ëŒ€í•´ì„œ ì¸ì§€ ë‹¤ í•˜ì…¨ì–ì•„ìš”.
ë„¤
ë³¸ì¸ ì•ìœ¼ë¡œ ì§‘í–‰ëª…ë ¹ ì‹œê°„ì´ ë°œë¶€ê°€ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ê·¸ ì‹œê°„ì•ˆì— ë°©ë¬¸ì´ ì•ˆ ë˜ì‹œë©´ ë³¸ì¸ ì²´í¬ì˜ì¥ ë–¨ì–´ì ¸ìš”""",
        "expected_min": 90,
        "type": "phishing"
    },
    {
        "id": "Case 3",
        "name": "ë‚©ì¹˜ ë¹™ì ë³´ì´ìŠ¤í”¼ì‹±",
        "text": """ì„¸ì˜ì´ ì—„ë§ˆì£ ?
ë„¤ë„¤
ë„¤ ì„¸ì˜ì´ ë°”ê¿” ì¤„ê²Œìš”
ë„¤
ë°›ì•„ ë´
ì—„ë§ˆ
ì™œ
ë¹¨ë¦¬ì™€..
ë­?
ì´ ì‚¬ëŒì´ ë•Œë ¸ì–´
ì–´? ëˆ„ê°€
ìˆ ì·¨í•œ ì‚¬ëŒì´
ì–´ë””? ì–´ë”˜ë° ë„ˆ?
ê³¨ëª©ì—â€¦
ë„ˆ ì–´ë””.. ì–´ë”” ê³¨ëª©ì¸ë°?
ì„¸ì˜ì•„ ì¤˜ ë´ ìš¸ì§€ë§ë¼ê³  ì•¼.
ëˆ„êµ¬ì„¸ìš”?
ì•„ ì•„ë‹ˆ, ì €í¬ ë”¸.. ì €í¬ë”¸í•œí…Œ ì™œ ê·¸ëŸ¬ì„¸ìš”
ë‚´ê°€ ë§í•˜ëŠ” ê±° ë“£ê³  ë„ˆëŠ” ë§ì„ í•˜ì§€ ë§ˆ
ë„¤
ë­˜ í•´ì£¼ë©´ ë ê¹Œìš”ë¶€í„° ë¬¼ì–´ë´
ë„¤, ë­˜ í•´ì£¼ë©´ ë˜ëŠ”ë°ìš”?
ë‚´ ê³„ì¢Œì—100ë§Œì›, 100ë§Œì›, 200ë§Œì›ë§Œ ë„£ì–´ì¤˜. ë†í˜‘ ë¶ˆëŸ¬ì¤„ê²Œìš”. ì§€ê¸ˆ ë°”ë¡œ ì…ê¸ˆí•˜ì„¸ìš”
ì•„ë‹ˆ ì €í¬ ë”¸ì„ ì–´ë”” ë°ë¦¬ê³ 
ë„¤ ë”¸ì„ ìœ„í•œ ë„¤ ë§ˆì§€ë§‰ ê¸°íšŒì¸ë°
ê³„ì¢Œë²ˆí˜¸ ì•Œë ¤ì£¼ì„¸ìš”
ê·¸ëŸ¬ë©´ ë°± ë§Œì› ì§€ê¸ˆ ì´ì²´í•˜ì„¸ìš”
20ì´ˆ ë‚´ë¡œ ì•ˆ ë³´ë‚´ë©´ ì „í™” ëŠê² ë‹¤. ì´ì²´ ì™„ë£Œ ëë‚˜?
ë„¤
ì§€ê¸ˆ ì”ì•¡ ì–¼ë§ˆ ë‚¨ì•˜ë‚˜?
ì œê°€ ì›”ê¸‰ë‚  ë§ˆì € ë³´ë‚´ë“œë¦´ê²Œìš”
ì œ ë”¸ë§Œ ë¬´ì‚¬íˆ ë³´ë‚´ì£¼ì„¸ìš”
ë³´ë‚´ì¤€ë‹¤ê³  í–ˆì–ì•„ ê·¸ë˜ì„œ ë„ˆëŠ” ì—„ì²­ ê³ ë§ˆìš´ ê±°ì•¼. ê·¸ë˜ì„œ ì¡°ê¸ˆ ì „ì— ëˆ ë³´ë‚¸ê±° ì‚¬ì§„ ë³´ë‚´ë‹¬ë¼ê³  í–ˆì–ì•„. ì§€ê¸ˆ ì”ì•¡ì´ 70ë§Œì›ì¸ë° ì™œ ê±°ì§“ë§ í–ˆì„ê¹Œ?
ì‚¬ëŒì€ ê±°ì§“ë§ì„ í•˜ë©´ ì•ˆë¼. ë‚´ê°€ ê³„ì¢Œë²ˆí˜¸ ë‹¤ë¥¸ê±° ë¶ˆëŸ¬ì¤„ í…Œë‹ˆê¹Œ ì—¬ê¸°ì— 70 ë„£ìœ¼ì„¸ìš”.
ë‹¤ì‹œ í†µì§¸ë¡œ ë‹¤ ë³´ë‚¼ê²Œìš”
ì €í¬ ë”¸ ì–´ë”¨ëŠ”ë°ìš”?
ê·¸ê±° ì†¡ê¸ˆí•˜ê³  ë‚˜ì„œ. ì•¼ ì „í™” ëŠì„ê¹Œ? ì•„ì¤Œë§ˆ. ì§€ê¸ˆ ë‚¨í¸í•œí…Œ ì „í™”í•´ì„œ ì´ë˜ì„œ ëˆì„ ë³´ë‚´ëŠ” ë° ì‹ ê³ í•˜ì§€ ë§ì í•˜ê³  ë‚¨í¸ ë³´ê³  ë‚´ ë²ˆí˜¸ë¡œ ì „í™”í•˜ë¼ í•´. ì§€ê¸ˆ ë°”ë¡œ.""",
        "expected_min": 95,
        "type": "phishing"
    },
    {
        "id": "Case 4",
        "name": "ì¹´ë“œ ë°°ì†¡ ì‚¬ì¹­ (ìŠ¤ë¯¸ì‹± ìœ ë„)",
        "text": """ì—¬ë³´ì„¸ìš”?
ì˜ˆ ì—¬ë³´ì„¸ìš”?
ì˜ˆ
ì•„ ì˜ˆ ì¹´ë“œë°°ì†¡ ê¸°ì‚¬ì¸ë°ìš”
ì˜ˆ
ì˜ˆ. ì •ì„¸ì˜ì”¨ ë§ìœ¼ì„¸ìš”?
ë„¤
ì•„ ì´ê±° 00ì¹´ë“œ ë°°ì†¡í•˜ë ¤ê³  í•˜ëŠ”ë° ì§€ê¸ˆ ëŒì— ê³„ì‹¤ê¹Œìš”?
ì•„ ì§€ê¸ˆ 2~3ë¶„ ë‚´ë¡œ ë“¤ì–´ê°ˆê±°ì˜ˆìš”.
ì•„ ë‹¤ì„¯ì‹œ ë‚´ì— ë“¤ì–´ê°ˆê±°ì˜ˆìš”. ì§€ê¸ˆì€ ì•„ë‹ˆêµ¬ìš”.
ì•„ë‹ˆ ê·¼ë° 00ì—ì„œ ë¬´ìŠ¨ ì¹´ë“œìš”?
000ì”¨ ì•„ë‹ˆì„¸ìš”?
ì•„ ë§ì•„ìš”. ì œê°€ ë­˜ ì‹ ì²­í–ˆë‚˜?
ê·¼ë° ì‹ ì²­ ì•ˆí•˜ì…¨ì–´ìš”?
ë„¤
ì‹ ì²­ì„ ì•ˆ í•˜ì…¨ëŠ”ë° ì¹´ë“œê°€ ë‚˜ì˜¬ ì¼ì´ ì—†ëŠ”ë° ì ì‹œë§Œìš”
ì¹´ë“œ ìš°í¸ë¬¼ì„ ë³´ë©´ 000ì”¨
ë„¤ ë§ì•„ìš”
58ë…„ìƒ 0ì›” 0ì¼ ì „í™”ë²ˆí˜¸, ì •ë³´ê°€ ë‹¤ ë§ë‹¤êµ¬ìš”?
ë„¤
ê·¸ëŸ¼ ì œê°€ ì§€ê¸ˆ ë°°ì†¡ì§€ì  ë“¤ì–´ê°€ê¸° ì „ì—
ë„¤
í™•ì¸ì „í™” ë“œë¦° ê±´ë° ì£¼ì†Œ.. ìíƒ ì£¼ì†Œê°€
ì„œìš¸ ë§ˆí¬êµ¬ ë„í™”ë™..
ì•„ë‹ˆ ì„œìš¸ì´ ì•„ë‹ˆê³  ì—¬ê¸° ì²­ì£¼ì˜ˆìš”
ì²­ì£¼ì‹œë¼êµ¬ìš”?
ë„¤
ì–´ ì´ê±° ê·¸ëŸ¼ ì‹ ì²­í•˜ì‹  ê²ƒë„ ì•„ë‹ˆê³ , ë³¸ì‚¬ë‘ í†µí™”ë¥¼ ë˜ ì•ˆí•˜ì…¨ì–ì•„ìš”. ì£¼ì†Œë„ í‹€ë¦¬ê³  ..
00ì¹´ë“œì‚¬ì— ì „í™”í•˜ì…”ì„œ ì·¨ì†Œ ì ‘ìˆ˜ë¥¼ í•œ ë²ˆ í•´ì£¼ì‹œê² ì–´ìš”? ì œê°€ ë°˜ì†¡ì²˜ë¦¬ í•˜ê²Œ
ì˜ˆ ì˜ˆ ì•Œê² ìŠµë‹ˆë‹¤
ì•„ ì´ì™•ì´ë©´ ì‚¬ê³ ì˜ˆë°©íŒ€ì´ë¼ê³  ìˆê±°ë“ ìš”
ê±°ê¸°ë¡œ ì°¾ì•„ì„œ ì „í™”í•œ ë²ˆ í•´ë³´ì„¸ìš”.
ì‚¬ê³  ì˜ˆë°©íŒ€?
ì£¼ì†Œë„ í‹€ë¦¬ê³  í•˜ë‹ˆê¹Œìš”
ì£¼ì†Œê°€ ì™œ ì„œìš¸ë¡œ ë˜ì–´ìˆì–´ìš”?
ê·¸ê±°ëŠ” ì œê°€ ì € ë°°ì†¡ê¸°ì‚¬ë¼.. ì ì‹œë§Œìš”
ì´ ìš°í¸ë¬¼ì— ë³´ë©´ 00ì¹´ë“œ ì‚¬ê³  ì˜ˆë°©íŒ€ ì „í™”ë²ˆí˜¸ ìˆëŠ”ë° ë¶ˆëŸ¬ë“œë¦´ê²Œìš”.
ì˜ˆ ë¶ˆëŸ¬ì£¼ì„¸ìš”
ì˜ˆ 1800-0000ì´ìš”. ì´ê²Œ ì¬ë°œê¸‰ì¸ì§€ ì´ê²Œ ë­”ì§€ ì£¼ì†Œë„ í‹€ë¦¬ë‹¤ê³  í•œ ë²ˆ ì–˜ê¸°ë¥¼ í•´ë³´ì‹œê³ 
ì˜ˆ
ê·¸ëŸ¼ ì €ëŠ” ì „í™”ê°€ ì˜¤ë©´ ë°˜ì†¡ ì²˜ë¦¬í•˜ë“ ê°€ ì•„ë‹ˆë©´ ì´ê±° ì£¼ì†Œ ë³€ê²½í•˜ë©´ ê·¸ê±° í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
ë„¤ ì•Œê² ìŠµë‹ˆë‹¤
ì˜ˆ""",
        "expected_min": 75,
        "type": "phishing"
    },
    {
        "id": "Case 5",
        "name": "ëŒ€ì¶œ ë¹™ì (ì•± ì„¤ì¹˜ ìœ ë„)",
        "text": """ê³ ê°ë‹˜ ì§€ê¸ˆ íœ´ëŒ€í°ì— ì€í–‰ ì–´í”Œ ì´ìš©í•˜ëŠ” ê±° ìˆìœ¼ì‹œì£ ?
ë„¤
ë„¤ ê·¸ ì€í–‰ì–´í”Œ ì•ˆì— ê³ ê°ë‹˜ ê¸ˆìœµì¸ì¦ì„œë‚˜ ê³µë™ì¸ì¦ì„œ ìˆìœ¼ì‹œì–ì•„ìš”
ë„¤
ìš”ì¦˜ ì›Œë‚™ì— ì¸ì¦ì„œ í•´í‚¹ì„ í†µí•œ ìŠ¤ë¯¸ì‹±, ë³´ì´ìŠ¤í”¼ì‹± ë²”ì£„ê°€ ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ì„œ, ì§€ê¸ˆ í˜„ì¬ ì €í¬ ìª½ ë³´ì•ˆ í”„ë¡œê·¸ë¨ ì‘ë™í•˜ê²Œ ë˜ë©´ì„œ ê³ ê°ë‹˜ ì¸ì¦ì„œ ë³´í˜¸ë¥¼ ìœ„í•´ ì€í–‰ ì–´í”Œ ê°™ì€ê²Œ ì ì‹œ ì°¨ë‹¨ì´ ë  ê±°ì˜ˆìš”. ì°¨ë‹¨ì´ ë˜ì…¨ë‹¤ê³  í•´ì„œ ê³ ê°ë‹˜ê»˜ì„œ ë‹¤ì‹œ ì„¤ì¹˜í•˜ì…”ì„œ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹ˆê³ ìš”, ì „ìì„œëª… í•˜ì‹œë©´ ì „ì‚° ë³µêµ¬ì²˜ë¦¬ ë˜ì‹œê¸° ë•Œë¬¸ì— ë¶ˆí¸í•˜ì‹œë”ë¼ë„ ì„œëª…í•˜ê¸° ì „ê¹Œì§€ë§Œ ì€í–‰ê¶Œ ì–´í”Œ ì‚¬ìš©ì€ ì•ˆ ë˜ì‹¤ê±°êµ¬ìš”. ì„œëª…í•˜ì‹œê³  ë‚˜ì„œëŠ” ì€í–‰ê¶Œ ì–´í”Œ ì „ì‚° í’€ì–´ë“œë¦´ ê±°ê³  ê³ ê°ë‹˜ ëŒ€ì¶œê¸ˆ ë“¤ì–´ì˜¨ ê±° í™•ì¸í•´ë³´ì…”ì•¼ ë˜ì–ì•„ìš”. ê·¸ ë‹¤ìŒì— ì€í–‰ê¶Œ ì–´í”Œ ì‚¬ìš©ì€ ê°€ëŠ¥í•˜ì„¸ìš”. ê·¸ëŸ¬ì‹œê³  ì§€ê¸ˆ ì‹ ì²­ì„œ ì‘ì„±í•´ì£¼ì‹ ê±° ê²°ì œë¶€ë¡œ ì´ê´€ì²˜ë¦¬ ë„ì™€ë“œë¦´ê±°ê³ , í•œ ì‹œê°„ ì•ˆìª½ìœ¼ë¡œ ì €í¬ ëŒ€í‘œë²ˆí˜¸ë¡œ ì—°ë½ ë“¤ì–´ê°€ì‹¤ ê±°ì˜ˆìš”. ìµœì¢… ìŠ¹ì¸ì „í™” ë“¤ì–´ê°€ì‹œëŠ” ê±´ë° ê³ ê°ë‹˜ê»˜ì„œ ëŒ€ì¶œ ì‹ ì²­í•œ ê²Œ ë§ëŠ”ì§€, ë­ ê²°ì œì¼ì€ ë©°ì¹ ë¡œ ì§€ì •ì„ í•  ê±´ì§€ ë“±ë“± ì—¬ì­¤ë³´ì‹¤ê±´ë° ê·¸ ë•Œ ë§ì”€ë§Œ ì˜ í•´ì£¼ì‹œë©´ ë˜ê³ ìš”.
ë„¤ ì•Œê² ìŠµë‹ˆë‹¤. ì•„ ê·¸ë¦¬ê³  í•œ ê°€ì§€ë§Œ ë§ì”€ë“œë¦¬ê³  ì‹¶ì€ë°ìš”
ì œê°€ ì§€ê¸ˆ ì „í™”ìƒìœ¼ë¡œ í•˜ëŠ” ê±°ê¸° ë•Œë¬¸ì—
ë„¤ ë§ì•„ìš”
ì œê°€ ì§€ê¸ˆ ì œ ì •ë³´ë¥¼ ì „ë¶€ ë‹¤ ë“œë ¸ì–ì•„ìš”
ë„¤
ê·¸ë˜ì„œ ì € ì‚¬ì‹¤ ë³´ì´ìŠ¤ í”¼ì‹±ì´ ë  ê¹Œë´ ê±±ì •ë„ ë˜ê±°ë“ ìš”
ì§€ê¸ˆ ëŒ€ì¶œë°›ì•„ì„œ ëŒ€ì¶œê¸ˆì„ ë°›ì§€ë„ ì•Šì•˜ê³ 
ê·¸ë˜ì„œ ì§€ê¸ˆ 0000ì´ ì €ì¶•ì€í–‰ì—ì„œ ì§€ê¸ˆ ì§€ìˆ˜ë‹˜ ì´ì§€ìˆ˜? ì§€ê¸ˆ ì§í•¨ì´?
ëŒ€ë¦¬ì˜ˆìš”.
ëŒ€ë¦¬ë‹˜ ì´ê±° ì œê°€ í™•ì¸í•œë²ˆ í•´ë³¼ê±°ì˜ˆìš”. ì§€ê¸ˆ ì—¬ê¸° 0000 ì €ì¶•ì€í–‰ìœ¼ë¡œ
ë„¤ ê°€ëŠ¥í•˜ì‹­ë‹ˆë‹¤
ì €ë„ ê±±ì •ì´ ë˜ê¸° ë•Œë¬¸ì— ê·¸ë ‡ë‹¤ê³  ì§€ê¸ˆ
ë„¤
ì–´ì°¨í”¼ ì§€ê¸ˆ ì œê°€ ì •ë³´ë¥¼ ë‹¤ ë“œë ¸ê¸° ë–„ë¬¸ì—
ì§€ê¸ˆ ì¡°ê¸ˆ ëŠ¦ì€ ê°ì´ ì—†ì§„ ì•Šì§€ë§Œ ê·¸ë˜ë„ ì¢€ í™•ì¸í•œ ë²ˆ í•´ë³´ê³  ì‹¶ì–´ì„œìš”.
ì–´ ë„¤ í™•ì¸ í•œ ë²ˆ í•´ë³´ì„¸ìš” ê³ ê°ë‹˜. ê·¸ë¦¬ê³  ì œê²Œ ë¬¸ì í•œë²ˆ ë‚¨ê²¨ì£¼ì„¸ìš”
ë„¤ ì•Œê² ìŠµë‹ˆë‹¤""",
        "expected_min": 70,
        "type": "phishing"
    },
    {
        "id": "Case 6",
        "name": "ì„±ë§¤ë§¤ í˜‘ë°• (ë§ˆì‚¬ì§€ ì—…ì†Œ ì‚¬ì¹­)",
        "text": """í”¼í•´ë³´ì‹¤ ë§Œí•œ ì¼ì´ ì¢€ ìƒê²¨ì„œ ì—°ë½ë“œë¦¬ê²Œë˜ì—ˆìŠµë‹ˆë‹¤
í”¼í•´ìš”?
ë„¤ì¢€ ê°„ë‹¨í•˜ê²Œ ì¢€ ë§ì”€ë“œë¦´ê²Œìš” ì •ì„¸ì˜ì”¨
ë„¤
ê·¸ ë•Œ ë‹¹ì‹œì— ì €í¬ê°€ ì¥ì‚¬ê°€ ë„ˆë¬´ ì•ˆ ë¼ì„œ
ë°‘ì— ìˆëŠ” ì‹¤ì¥ë“¤ ì‹œì¼œì„œ ë°©ë§ˆë‹¤ ì¹´ë©”ë¼ë¥¼ ì„¤ì¹˜í•´ë‘ê³ 
ë„¤
ì˜ìƒì„ ì¢€ ì´¬ì˜í–ˆê³ ìš”
ê·¸ ì˜ìƒì„ ì •ë¦¬í•˜ë˜ ì¤‘ì—
ì •ì„¸ì˜ì”¨ ì˜ìƒì´ ë‚˜ì˜¤ê²Œ ë˜ì–´ì„œ ì§€ê¸ˆ ì—°ë½ í•œ í†µ ë“œë¦¬ê²Œ ëœ ê±°ê³ 
ì €í¬ê°€ í¥ì‹ ì†Œë¥¼ ê°™ì´ ìš´ì˜í•˜ë‹¤ ë³´ë‹ˆê¹Œ ì •ì„¸ì˜ì”¨ ë­ 00ë…„ 00ì›” 00ìƒì¸ê²ƒê¹Œì§€ í•´ì„œ ë³¸ì¸ ê°€ì¡±, ì§€ì¸ë“¤ ì—°ë½ì²˜ë¥¼ í•œ 40ê°œ ì •ë„ í™•ë³´í•œ ìƒíƒœì—ì„œ ì´ë ‡ê²Œ ì—°ë½ì„ ë“œë¦¬ê²Œ ë˜ì—ˆê³ ìš”.
ì •ì„¸ì˜ ì”¨ ì§€ê¸ˆ ì‚¬íƒœíŒŒì•…ì´ ì˜ ì•ˆë˜ì‹œëŠ” ê²ƒ ê°™ì€ë°, ë‚´ê°€ ì§€ê¸ˆë¶€í„° ì‚¬íƒœíŒŒì•…ì´ ë˜ê²Œë” ë‹¨í†¡ë°© í•˜ë‚˜ ë§Œë“¤ì–´ì„œ ê°€ì¡±, ì§€ì¸ë“¤ í•œ ìŠ¤ë¬´ ëª… ì´ˆëŒ€í•´ ë†“ê³  ë³¸ì¸ ì˜ìƒ ì˜¬ë ¤ì„œ ì§€ì €ë¶„í•˜ê²Œ ì–˜ê¸°í• ê¹Œìš”? ì•„ë‹ˆë©´ ë‚˜ë‘ ì¢‹ê²Œ í•œ ë²ˆ ì–˜ê¸°í•´ë³´ì‹¤ë˜ìš”?
ë­ ì¼ë‹¨ í™•ì¸ë¶€í„° ì¢€ í•´ë³¼ê²Œìš”
ì¥ë‚œ ê°™ì•„ìš”?
ì¥ë‚œ ì•„ë‹ˆì£ 
ì§€ê¸ˆ ë‹¨í†¡ë°© í•˜ë‚˜ ë§Œë“¤ í…Œë‹ˆê¹Œ ê±°ê¸°ì„œ í™•ì¸í•˜ì‹œê³ 
ë„¤
ì‹ ê³ ì ì „í™” ëŠìŒ""",
        "expected_min": 85,
        "type": "phishing"
    }
]


def main():
    print("=" * 100)
    print("ğŸ§ª test.txt ì‹¤ì œ ë³´ì´ìŠ¤í”¼ì‹± ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸ (Gemini 2.5 Flash + Rule Filter)")
    print("=" * 100)
    print()

    detector = GeminiPhishingDetector()

    if not detector.is_available():
        print("âŒ Gemini APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. .env íŒŒì¼ì— GEMINI_API_KEYë¥¼ ì„¤ì •í•˜ì„¸ìš”.")
        return

    results = []
    correct = 0
    total = len(test_cases)

    for i, case in enumerate(test_cases, 1):
        print(f"\n{'='*100}")
        print(f"[{i}/{total}] {case['id']}: {case['name']}")
        print(f"{'='*100}")
        print(f"ì…ë ¥ í…ìŠ¤íŠ¸ (ì²˜ìŒ 200ì):\n{case['text'][:200]}...")
        print(f"\nê¸°ëŒ€ ì ìˆ˜: â‰¥{case['expected_min']} (í”¼ì‹±)")

        try:
            # Gemini + Filter ë¶„ì„
            result = detector.analyze(case["text"], enable_filter=True)

            score = result["score"]
            is_phishing = result["is_phishing"]
            risk_level = result["risk_level"]
            reasoning = result.get("reasoning", "")

            llm_score = result.get("llm_score", score)
            filter_applied = result.get("filter_applied", False)

            # ì •ë‹µ íŒì •
            is_correct = score >= case["expected_min"]
            status = "âœ…" if is_correct else "âŒ"

            print(f"\nğŸ“Š ë¶„ì„ ê²°ê³¼:")
            print(f"  - LLM ì›ë³¸ ì ìˆ˜: {llm_score}")
            print(f"  - ìµœì¢… ì ìˆ˜: {score}")
            print(f"  - ìœ„í—˜ë„: {risk_level}")
            print(f"  - í”¼ì‹± íŒì •: {'ì˜ˆ' if is_phishing else 'ì•„ë‹ˆì˜¤'}")

            if filter_applied:
                arrow = "â†“" if score < llm_score else "â†‘"
                print(f"  - âœ“ Rule Filter ì ìš©: {llm_score} {arrow} {score}")

            print(f"\nğŸ’¡ íŒì • ì´ìœ :")
            print(f"  {reasoning[:300]}...")

            print(f"\n{status} ê²°ê³¼: {'ì •ë‹µ' if is_correct else 'ì˜¤ë‹µ'} (ê¸°ëŒ€: â‰¥{case['expected_min']}, ì‹¤ì œ: {score})")

            if is_correct:
                correct += 1

            results.append({
                "id": case["id"],
                "name": case["name"],
                "llm_score": llm_score,
                "final_score": score,
                "is_correct": is_correct,
                "filter_applied": filter_applied
            })

            # API ê³¼ë¶€í•˜ ë°©ì§€
            time.sleep(2)

        except Exception as e:
            print(f"\nâŒ ì˜¤ë¥˜ ë°œìƒ: {str(e)}")
            results.append({
                "id": case["id"],
                "name": case["name"],
                "llm_score": 0,
                "final_score": 0,
                "is_correct": False,
                "filter_applied": False
            })

    # ìµœì¢… ê²°ê³¼
    print("\n" + "=" * 100)
    print("ğŸ“Š ìµœì¢… í…ŒìŠ¤íŠ¸ ê²°ê³¼")
    print("=" * 100)

    accuracy = (correct / total) * 100
    print(f"\nì „ì²´ ì •í™•ë„: {accuracy:.1f}% ({correct}/{total})")

    print("\nìƒì„¸ ê²°ê³¼:")
    print(f"{'ID':<12} {'ì¼€ì´ìŠ¤ëª…':<35} {'LLM ì ìˆ˜':<10} {'ìµœì¢… ì ìˆ˜':<10} {'í•„í„°':<8} {'ê²°ê³¼':<8}")
    print("-" * 100)

    for r in results:
        filter_mark = "âœ“" if r["filter_applied"] else "-"
        result_mark = "âœ…" if r["is_correct"] else "âŒ"
        print(f"{r['id']:<12} {r['name']:<35} {r['llm_score']:<10} {r['final_score']:<10} {filter_mark:<8} {result_mark:<8}")

    print("\n" + "=" * 100)
    print("âœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")
    print("=" * 100)


if __name__ == "__main__":
    main()
