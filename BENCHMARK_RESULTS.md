# 🔬 LLM 보이스피싱 탐지 벤치마크 결과

## 📋 테스트 개요

**테스트 일시**: 2026-01-28
**테스트 케이스**: 27개 (전통 피싱 10개, 정상 3개, URL 피싱 10개, 신규 유형 4개)
**테스트 LLM**: 5개 (Claude 3.5 Haiku, Gemini 2.5 Flash, GPT-4o, DeepSeek V3, Perplexity Sonar)

---

## 🎯 분석 프롬프트

```
당신은 보이스피싱 탐지 전문가입니다. 다음 통화 내용을 분석하세요.

**분석 기준:**
1. 공공기관/기업 사칭
2. 장소 이동 요구
3. 앱 설치 유도
4. 심리적 압박
5. 가짜 URL (.com, .net 등)
6. 정상 케이스: 예약 일정, 공식 홈페이지, 합리적 목적

**응답 형식 (JSON):**
{
  "score": <0-100 정수>,
  "is_phishing": <true/false>,
  "reasoning": "<1-2문장>"
}
```

---

## 🏆 최종 순위

| 순위 | LLM | 전체 정답률 | 정답 수 |
|------|-----|-------------|---------|
| 🥇 1위 | **GPT-4o** | **96.3%** | 26/27 |
| 🥇 1위 | **Gemini 2.5 Flash** | **96.3%** | 26/27 |
| 🥉 3위 | DeepSeek V3 | 92.6% | 25/27 |
| 4위 | Claude 3.5 Haiku | 88.9% | 24/27 |
| 4위 | Perplexity Sonar | 88.9% | 24/27 |

---

## 📊 카테고리별 성능 분석

### Category A: 전통적 보이스피싱 (10개)

| LLM | 정답률 | 정답 수 |
|-----|--------|---------|
| Claude 3.5 Haiku | **100%** | 10/10 |
| Gemini 2.5 Flash | **100%** | 10/10 |
| GPT-4o | **100%** | 10/10 |
| DeepSeek V3 | **100%** | 10/10 |
| Perplexity Sonar | 90% | 9/10 |

**결과**: 전통적 보이스피싱 패턴은 거의 모든 LLM이 완벽하게 탐지

---

### Category B: 정상 케이스 (3개) ⚠️

| LLM | 정답률 | 정답 수 | 오탐 케이스 |
|-----|--------|---------|-------------|
| Gemini 2.5 Flash | **66.7%** | 2/3 | 원격지원 1건 |
| GPT-4o | **66.7%** | 2/3 | 원격지원 1건 |
| DeepSeek V3 | 33.3% | 1/3 | 원격지원, 채용검사 |
| Perplexity Sonar | 33.3% | 1/3 | 원격지원, 채용검사 |
| Claude 3.5 Haiku | **0%** | 0/3 | 전부 오탐 ❌ |

**문제점**: False Positive (정상을 피싱으로 오인) 비율이 높음
- 심리상담, 원격지원, 채용검사 등 정상 서비스와 피싱의 구별이 어려움
- Claude Haiku는 정상 케이스를 전부 피싱으로 판단

---

### Category C: URL 기반 피싱 (10개)

| LLM | 정답률 | 정답 수 |
|-----|--------|---------|
| Claude 3.5 Haiku | **100%** | 10/10 |
| Gemini 2.5 Flash | **100%** | 10/10 |
| GPT-4o | **100%** | 10/10 |
| DeepSeek V3 | **100%** | 10/10 |
| Perplexity Sonar | **100%** | 10/10 |

**결과**: 가짜 URL을 포함한 피싱은 모든 LLM이 완벽 탐지

---

### Category D: 신규 공격 유형 (4개)

로맨스 스캠, 딥보이스 납치, 부고장 스미싱, 고수익 알바

| LLM | 정답률 | 정답 수 |
|-----|--------|---------|
| Claude 3.5 Haiku | **100%** | 4/4 |
| Gemini 2.5 Flash | **100%** | 4/4 |
| GPT-4o | **100%** | 4/4 |
| DeepSeek V3 | **100%** | 4/4 |
| Perplexity Sonar | **100%** | 4/4 |

**결과**: 최신 공격 유형도 모든 LLM이 완벽 탐지

---

## 📝 테스트 케이스 상세

### Category A: 전통적 보이스피싱

1. **A01 - 노골적 위협** (min 90점)
   > "야, 서울지검인데 너 대포통장 신고 들어왔어. 지금 당장 가까운 모텔로 튀어와..."

2. **A02 - 어설픈 사칭** (min 85점)
   > "여기는 중앙지방검찰청입니다. 본인 계좌가 범죄에 연루되어..."

3. **A03 - 전형적 시나리오** (min 85점)
   > "김철수 검사입니다. 수사 기밀 유지를 위해 제3자가 없는 독립된 공간이..."

4. **A04 - 피해자 구제 빙자** (min 75점)
   > "선생님이 피의자가 아니라 피해자 입장이신 걸 소명하려는 겁니다..."

5. **A05 - 기술 지원 위장** (min 75점)
   > "지금 폰이 해킹된 상태라 위치 추적이 되고 있어요..."

6. **A06 - 금감원 사칭** (min 70점)
   > "금융감독원 자산보호팀입니다. 현재 자금이 해외로 빠져나가고..."

7. **A07 - 가족 사칭** (min 70점)
   > "아버님, 저 김 대리입니다. 따님이 사고 합의 건으로..."

8. **A08 - 면접 위장** (min 65점)
   > "OO기업 인사팀입니다. 1차 합격 축하드립니다. 2차는 AI 역량 검사로..."

9. **A09 - 가짜 백신** (min 65점)
   > "OO카드 FDS팀입니다. 지금 고객님 폰에 악성코드가 심어져서..."

10. **A10 - 생체인증 위장** (min 60점)
    > "본인 확인 절차가 강화되었습니다. 목소리의 생체 파형을 등록해야..."

---

### Category B: 정상 케이스 (False Positive 테스트)

1. **B01 - 심리상담** (max 30점) ✅
   > "OO정신건강의학과입니다. 예약하신 비대면 진료 시간..."
   - **결과**: GPT 20점 ✅, Gemini 10점 ✅, Perplexity 15점 ✅, DeepSeek 85점 ❌, Claude 40점 ❌

2. **B02 - 원격지원** (max 30점) ⚠️
   > "와이파이 끊김 현상은 설정 충돌 문제로 보입니다. 원격 상담 기능..."
   - **결과**: 대부분의 LLM이 오탐 (70-95점)

3. **B03 - 채용검사** (max 30점) ⚠️
   > "OO그룹 인사팀입니다. 온라인 AI 역량 검사 관련해서..."
   - **결과**: GPT 20점 ✅, Gemini 10점 ✅, 나머지 오탐 (30-85점)

---

### Category C: URL 기반 피싱

1. **C01 - 대법원 위장** (min 70점)
   > "scourt-law.com 입력하시면 대법원 형사 사법 포털..."

2. **C02 - 검찰청 위장** (min 75점)
   > "서울중앙지검 홈페이지(spo-invest.net) 접속하셔서..."

3. **C03 - 금감원 동결** (min 75점)
   > "금융감독원 민원 포털(fss-secure.co.kr) 들어가셔서..."

4. **C04 - 국세청 환급** (min 70점)
   > "국세청 환급 센터(nts-refund.kr)에서 신청하세요..."

5. **C05 - 건강검진 위장** (min 65점)
   > "국민건강보험 홈페이지(nhis-checkup.com)에서..."

6. **C06 - 장학금 위장** (min 65점)
   > "한국장학재단 긴급 지원금(kosaf-apply.net)..."

7. **C07 - 대환대출 위장** (min 60점)
   > "금융위원회 대환대출 지원센터(fsc-loan.co.kr)..."

8. **C08 - 택배 스미싱** (min 60점)
   > "택배 조회: cj-logistics-track.com..."

9. **C09 - 코인 거래소** (min 65점)
   > "업비트 긴급 공지(upbit-notice.net)..."

10. **C10 - 2차 피해** (min 60점)
    > "피싱 피해 구제 센터(police-recovery.kr)..."

---

### Category D: 신규 공격 유형

1. **D01 - 로맨스 스캠 (Pig Butchering)** (min 60점)
   > "저는 싱가포르에서 투자 회사를 운영하는 마크입니다. 당신에게 특별한 투자 기회를..."

2. **D02 - 딥보이스 납치** (min 70점)
   > "(울먹이는 목소리로) 아빠! 나 사고 쳤어... 횡단보도에서 사람을 쳤는데..."

3. **D03 - 부고장 스미싱** (min 50점)
   > "[부고] 모친상. 장례식장: 연세세브란스병원. 약도: bit.ly/funeral_kr"

4. **D04 - 고수익 알바** (min 60점)
   > "법무사 사무실인데요, 개인 계좌로 돈을 받아서 이체만 해주시면 건당 10만 원..."

---

## 🔍 주요 발견사항

### ✅ 강점

1. **전통 피싱 탐지 우수**: 검찰/금감원/경찰 사칭 등 전통적 패턴 90-100% 탐지
2. **URL 패턴 인식 완벽**: 가짜 도메인(.com, .net) 100% 탐지
3. **신규 공격 대응 가능**: 로맨스 스캠, 딥보이스 등 최신 기법도 100% 탐지
4. **컨텍스트 이해**: 디지털 감금(모텔 이동 + 앱 설치) 패턴 인식

### ⚠️ 약점

1. **False Positive 높음**: 정상 서비스를 피싱으로 오인하는 비율 33-100%
2. **정상/피싱 경계 모호**: 원격지원, 채용검사 등 합법적 요청과 구별 어려움
3. **Claude Haiku 문제**: JSON 파싱 에러 빈번 + 정상 케이스 전부 오탐
4. **과도한 민감성**: 보수적 판단으로 정상 케이스도 위험 신호로 해석

---

## 🎯 LLM별 상세 평가

### 🥇 GPT-4o (96.3%, 26/27)

**강점**:
- 전통/URL/신규 피싱 100% 탐지
- False Positive 최저 (정상 케이스 66.7% 정답)
- 안정적인 JSON 응답

**약점**:
- 원격지원 케이스 1건 오탐 (85점)

**추천 용도**: ✅ 실전 배포 최적

---

### 🥇 Gemini 2.5 Flash (96.3%, 26/27)

**강점**:
- GPT-4o와 동일한 성능
- 빠른 응답 속도
- 전통/URL/신규 피싱 100% 탐지

**약점**:
- 원격지원 케이스 1건 오탐 (85점)
- 일부 JSON 파싱 에러 발생

**추천 용도**: ✅ 실전 배포 최적 (GPT 대안)

---

### 🥉 DeepSeek V3 (92.6%, 25/27)

**강점**:
- 전통/URL/신규 피싱 100% 탐지
- 비용 효율적

**약점**:
- False Positive 높음 (정상 케이스 33.3%)
- 원격지원, 채용검사 오탐

**추천 용도**: 💰 예산 제약 시 고려

---

### Claude 3.5 Haiku (88.9%, 24/27)

**강점**:
- 전통/URL/신규 피싱 100% 탐지
- 민감한 탐지 (보수적 판단)

**약점**:
- ❌ 정상 케이스 전부 오탐 (0%)
- JSON 파싱 에러 빈번 ("Extra data")
- 과도하게 민감한 반응

**추천 용도**: ⚠️ 추가 튜닝 필요

---

### Perplexity Sonar (88.9%, 24/27)

**강점**:
- URL/신규 피싱 100% 탐지
- 실시간 웹 검색 기능

**약점**:
- 전통 피싱 1건 누락 (90%)
- False Positive 높음 (정상 케이스 33.3%)

**추천 용도**: 🔍 실시간 URL 검증 보조

---

## 💡 실전 배포 권장사항

### 🎯 1순위: GPT-4o 또는 Gemini 2.5 Flash

**이유**:
- 최고 정확도 (96.3%)
- 피싱 탐지율 100% (A+C+D 카테고리)
- False Positive 최저 (33.3%)
- 안정적인 API 응답

**배포 전략**:
```python
# Primary: GPT-4o
# Fallback: Gemini 2.5 Flash
# Score threshold: 70점 이상 경고, 85점 이상 차단
```

---

### 🔧 2순위: DeepSeek V3 (예산 제약 시)

**이유**:
- 피싱 탐지율 100%
- 비용 효율적
- GPT/Gemini 대비 성능 차이 적음 (4%)

**주의사항**:
- 정상 케이스 오탐 가능성 높음
- 추가 검증 로직 필요

---

### ⚠️ 비추천: Claude 3.5 Haiku

**이유**:
- 정상 케이스 전부 오탐 (0% 정답률)
- JSON 파싱 불안정
- 과도한 민감성으로 사용자 경험 저하

---

## 📈 향후 개선 방향

### 1. False Positive 감소

**현재 문제**:
- 원격지원, 채용검사 등 정상 서비스를 피싱으로 오인

**개선 방안**:
- 예약 일정 확인 로직 추가
- 공식 도메인 화이트리스트 구축
- 사용자 주도 vs 발신자 주도 구분

---

### 2. 컨텍스트 강화

**현재 문제**:
- 단순 키워드 매칭으로 오탐 발생

**개선 방안**:
- 대화 히스토리 활용
- 사전 예약 여부 확인
- 발신번호 검증 연계

---

### 3. 앙상블 시스템

**제안**:
```python
# 다수결 투표 시스템
def ensemble_detection(text):
    results = [
        gpt4o.analyze(text),
        gemini.analyze(text),
        deepseek.analyze(text)
    ]

    # 2개 이상 LLM이 피싱으로 판단 시 차단
    phishing_count = sum(1 for r in results if r['score'] >= 70)
    return phishing_count >= 2
```

---

## 🔗 관련 파일

- 벤치마크 스크립트: `scripts/final_benchmark_27.py`
- 테스트 케이스: `exam.md`
- LLM 클라이언트: `src/llm/llm_clients/`
- 전체 로그: `benchmark_5llms_final.txt`

---

## 📅 버전 정보

- **테스트 버전**: v1.0
- **테스트 일시**: 2026-01-28
- **마지막 업데이트**: 2026-01-28

---

**생성**: Sentinel-Voice 프로젝트 (DACON 보이스피싱 탐지 경진대회)
